<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valentine Message to Sayangku</title>
    <style>
        /* CSS Reset & Variables */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --pastel-pink: #ffd1dc;
            --pastel-green: #b8e0d2;
            --pastel-white: #fdfdfd;
            --text-dark: #4a4a4a;
            --error-red: #ff9eaa;
            --strong-pink: #ff6b81;
        }

        body {
            background: linear-gradient(135deg, var(--pastel-pink) 0%, var(--pastel-green) 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-dark);
            position: relative;
        }

        /* Animated Hearts Background */
        .heart {
            position: fixed;
            bottom: -50px;
            font-size: 1.5rem;
            animation: floatUp linear infinite;
            z-index: 0; 
            pointer-events: none;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            5% { opacity: 0.8; }
            95% { opacity: 0.8; }
            100% { transform: translateY(-120vh) scale(1.5); opacity: 0; } 
        }

        /* Main Container/Glass Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            padding: 15px; 
            width: 90%;
            max-width: 400px;
            text-align: center;
            z-index: 10;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            transition: all 0.5s ease;
            display: flex;
            flex-direction: column;
            height: auto; 
            position: relative; /* For popup positioning */
        }

        /* --- VIEW 1 STYLES --- */
        #view-1 {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 1rem; 
        }

        h1 { font-size: 1.8rem; color: var(--strong-pink); margin-bottom: 5px; }
        p { font-size: 0.95rem; line-height: 1.4; }
        .question { font-weight: bold; font-size: 1.1rem; margin: 10px 0; }

        input {
            padding: 12px;
            border-radius: 10px;
            border: 2px solid var(--pastel-white);
            background: rgba(255, 255, 255, 0.7);
            font-size: 1.2rem;
            text-align: center;
            outline: none;
            transition: 0.3s;
        }
        input:focus { border-color: var(--strong-pink); }

        .hint-text {
            color: #e63946;
            font-size: 0.85rem;
            min-height: 40px;
            font-style: italic;
        }

        /* Button Styles */
        button {
            background: var(--strong-pink);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px auto 0;
            box-shadow: 0 4px 15px rgba(255, 107, 129, 0.4);
            transition: transform 0.2s, background 0.3s, box-shadow 0.3s;
        }
        button:hover:not(.shiny-btn):not(:disabled) {
            transform: scale(1.05);
            background: #ff4760;
        }
        button:active { transform: scale(0.95); }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .shiny-btn {
            background: #4CAF50 !important;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.7), inset 0 0 10px rgba(255,255,255,0.4) !important;
            animation: pulse-glow 1.5s infinite !important;
        }

        @keyframes pulse-glow {
            0% { transform: scale(1); }
            50% { transform: scale(1.08); }
            100% { transform: scale(1); }
        }

        /* --- VIEW 2 STYLES --- */
        #view-2 {
            display: none;
            height: 55vh; 
            overflow-y: auto;
            padding: 5px; 
            margin-bottom: 5px; 
        }
        #view-2::-webkit-scrollbar { display: none; }
        #view-2 { -ms-overflow-style: none; scrollbar-width: none; }

        .card-grid { display: flex; flex-direction: column; gap: 15px; }

        /* Flip Card Styles */
        .flip-card {
            background-color: transparent;
            width: 100%;
            aspect-ratio: 1 / 1;
            perspective: 1000px;
            cursor: pointer;
        }
        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s cubic-bezier(0.4, 0.2, 0.2, 1);
            transform-style: preserve-3d;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .flip-card-front {
            background-color: var(--pastel-white);
            color: var(--text-dark);
            background-position: center;
            background-repeat: no-repeat;
            background-size: 60%; 
        }
        .click-hint {
            position: absolute;
            bottom: 15px;
            background: rgba(255,255,255,0.7);
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            color: var(--strong-pink);
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .flip-card-back {
            background-color: var(--pastel-green);
            color: var(--text-dark);
            transform: rotateY(180deg);
            font-size: 1.1rem;
            padding: 20px; 
        }

        /* --- VIEW 3 STYLES (TIC TAC TOE) --- */
        #view-3 {
            display: none;
            flex-direction: column;
            gap: 15px;
            padding: 10px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--strong-pink);
            border-bottom: 2px solid rgba(255,255,255,0.5);
            padding-bottom: 10px;
        }

        #gameCaption {
            font-size: 1rem;
            margin: 5px 0;
            min-height: 24px;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            /* NEW: Explicit rows to prevent resizing */
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            margin: 10px auto;
            width: 100%;
            max-width: 300px;
            aspect-ratio: 1 / 1;
        }

        .cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            /* NEW: Prevent vertical stretching */
            line-height: 1; 
            cursor: pointer;
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            transition: background 0.3s;
            border: 2px solid var(--strong-pink);
        }

        .cell:hover {
            background: rgba(255,255,255,0.6);
        }
        
        .cell.taken {
            cursor: default;
        }

        /* Cute Popup Message */
        .popup-msg {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            font-weight: bold;
            color: var(--strong-pink);
            white-space: nowrap;
            z-index: 100;
            animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }

        @keyframes popIn {
            0% { transform: translateX(-50%) scale(0); opacity: 0; }
            100% { transform: translateX(-50%) scale(1); opacity: 1; }
        }
    </style>
</head>
<body>

    <audio id="bgMusic" loop autoplay>
        <source src="song.mp3" type="audio/mpeg">
    </audio>

    <div id="hearts-container"></div>

    <div class="glass-card">
        
        <div id="view-1">
            <p style="color: #ff6b81; font-weight: bold; font-size: 0.9rem; margin-bottom: 5px;">Made with ü©∑ by Adam</p>
            <h1>Valentine Message for Sayangku</h1>
            <p>To unlock secret message provide a correct password (emoji)</p>
            <p class="question">What does the üêÆ like?</p>
            
            <input type="text" id="passwordInput" placeholder="Enter emoji..." autocomplete="off">
            <div id="hintBox" class="hint-text"></div>
            
            <button id="unlockBtn" onclick="checkPassword()">
                <span id="lockIcon">üîí</span> <span id="btnText">Locked</span>
            </button>
        </div>

        <div id="view-2">
            <h2>Some special words ü©∑</h2>
            <br>
            <div class="card-grid">
                
                <div class="flip-card" onclick="this.classList.toggle('flipped'); this.classList.add('viewed'); checkAllViewed();">
                    <div class="flip-card-inner">
                        <div class="flip-card-front" style="background-color: #ffe4e1; background-image: url('flowers.png');">
                            <span class="click-hint">Tap to flip ‚ú®</span>
                        </div>
                        <div class="flip-card-back">
                            <p>Can't wait for the time, when I can finally bring Lien her favourite flowers, at the times, when you're feeling sick, or in pain, in happy moments and special occasions juga... or just spontaneously to express my endless gratitude towards you for being such an amazing person</p>
                        </div>
                    </div>
                </div>

                <div class="flip-card" onclick="this.classList.toggle('flipped'); this.classList.add('viewed'); checkAllViewed();">
                    <div class="flip-card-inner">
                        <div class="flip-card-front" style="background-color: #e0f2f1; background-image: url('holdheart.png');">
                            <span class="click-hint">Tap to flip ‚ú®</span>
                        </div>
                        <div class="flip-card-back">
                            <p>Besides the flowers, I want to give you all the love I have, cuz you deserve it all &lt;3</p>
                        </div>
                    </div>
                </div>

                <div class="flip-card" onclick="this.classList.toggle('flipped'); this.classList.add('viewed'); checkAllViewed();">
                    <div class="flip-card-inner">
                        <div class="flip-card-front" style="background-color: #fff3e0; background-image: url('shinycow.png');">
                            <span class="click-hint">Tap to flip ‚ú®</span>
                        </div>
                        <div class="flip-card-back">
                            <p>Still can't believe what a lucky men I am, not only you have extraordinary and wise mind, but so breathtaking on the outside juga ‚ú®</p>
                        </div>
                    </div>
                </div>

                <div class="flip-card" onclick="this.classList.toggle('flipped'); this.classList.add('viewed'); checkAllViewed();">
                    <div class="flip-card-inner">
                        <div class="flip-card-front" style="background-color: #f3e5f5; background-image: url('holdmushroom.png');">
                            <span class="click-hint">Tap to flip ‚ú®</span>
                        </div>
                        <div class="flip-card-back">
                            <p>Adam mau to always hold each other back... just like lien holds üçÑ at night.</p>
                        </div>
                    </div>
                </div>

                <div class="flip-card" onclick="this.classList.toggle('flipped'); this.classList.add('viewed'); checkAllViewed();">
                    <div class="flip-card-inner">
                        <div class="flip-card-front" style="background-color: #e3f2fd; background-image: url('hornycow.png');">
                            <span class="click-hint">Tap to flip ‚ú®</span>
                        </div>
                        <div class="flip-card-back">
                            <p>Let's always be honest about our feelings... either if its sedih, rindu, joy, love or even horny üòä</p>
                        </div>
                    </div>
                </div>

                <div class="flip-card" onclick="this.classList.toggle('flipped'); this.classList.add('viewed'); checkAllViewed();">
                    <div class="flip-card-inner">
                        <div class="flip-card-front" style="background-color: #f1f8e9; background-image: url('yesyou.png');">
                            <span class="click-hint">Tap to flip ‚ú®</span>
                        </div>
                        <div class="flip-card-back">
                            <p>AND REMEMBER!!! You're always enough and never too much for adam ‚ù§Ô∏è</p>
                        </div>
                    </div>
                </div>

                <div class="flip-card" onclick="this.classList.toggle('flipped'); this.classList.add('viewed'); checkAllViewed();">
                    <div class="flip-card-inner">
                        <div class="flip-card-front" style="background-color: #fff8e1; background-image: url('turtle.png');">
                            <span class="click-hint">Tap to flip ‚ú®</span>
                        </div>
                        <div class="flip-card-back">
                            <p>Itu adam 98% of the time with Lien ü§≠</p>
                        </div>
                    </div>
                </div>

                <div class="flip-card" onclick="this.classList.toggle('flipped'); this.classList.add('viewed'); checkAllViewed();">
                    <div class="flip-card-inner">
                        <div class="flip-card-front" style="background-color: #fce4ec; background-image: url('ringcat.png');">
                            <span class="click-hint">Tap to flip ‚ú®</span>
                        </div>
                        <div class="flip-card-back">
                            <p>You are mine... my wifey ü•∞</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <button id="moreBtn" class="shiny-btn" onclick="showView3()" style="display: none; margin: 15px auto 0; width: 80%; font-size: 1.1rem;">
            There is still more ü§≠
        </button>

        <div id="view-3">
            <div class="game-header">
                <span>Tic Tac Toe Game</span>
                <span id="scoreCounter">üèÜ: 0/3</span>
            </div>
            
            <p id="gameCaption">Win 3 times to proceed ü§≠</p>
            
            <div class="game-board" id="gameBoard">
                <div class="cell" onclick="handleCellClick(0)"></div>
                <div class="cell" onclick="handleCellClick(1)"></div>
                <div class="cell" onclick="handleCellClick(2)"></div>
                <div class="cell" onclick="handleCellClick(3)"></div>
                <div class="cell" onclick="handleCellClick(4)"></div>
                <div class="cell" onclick="handleCellClick(5)"></div>
                <div class="cell" onclick="handleCellClick(6)"></div>
                <div class="cell" onclick="handleCellClick(7)"></div>
                <div class="cell" onclick="handleCellClick(8)"></div>
            </div>

            <button id="gameStartBtn" class="shiny-btn" onclick="startGame()">START GAME</button>
        </div>

    </div>

    <script>
        // --- ANIMATIONS & SETUP ---
        const heartsContainer = document.getElementById('hearts-container');
        const heartEmojis = ['ü§ç', 'üíö', 'ü©∑','‚ú®'];
        
        for (let i = 0; i < 20; i++) {
            let heart = document.createElement('div');
            heart.classList.add('heart');
            heart.innerText = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = (Math.random() * 6 + 6) + 's'; 
            heart.style.animationDelay = (Math.random() * -15) + 's'; 
            heart.style.fontSize = (Math.random() * 1.5 + 1) + 'rem';
            heartsContainer.appendChild(heart);
        }

        // --- AUDIO ---
        const bgMusic = document.getElementById('bgMusic');
        bgMusic.play().catch(e => console.log("Waiting for interaction"));
        function startAudio() {
            bgMusic.play().then(() => {
                document.removeEventListener('click', startAudio);
                document.removeEventListener('touchstart', startAudio);
                document.removeEventListener('keydown', startAudio);
            }).catch(e => {});
        }
        document.addEventListener('click', startAudio);
        document.addEventListener('touchstart', startAudio);
        document.addEventListener('keydown', startAudio);

        // --- VIEW 1 LOGIC ---
        const passwordInput = document.getElementById('passwordInput');
        const unlockBtn = document.getElementById('unlockBtn');
        const lockIcon = document.getElementById('lockIcon');
        const btnText = document.getElementById('btnText');
        const hintBox = document.getElementById('hintBox');

        passwordInput.addEventListener('input', function() {
            if (this.value.trim() === 'üçÑ') {
                lockIcon.innerText = 'üîì';
                btnText.innerText = 'Unlocked';
                unlockBtn.classList.add('shiny-btn');
                hintBox.innerText = "";
            } else {
                lockIcon.innerText = 'üîí';
                btnText.innerText = 'Locked';
                unlockBtn.classList.remove('shiny-btn');
            }
        });

        let failedAttempts = 0;
        function checkPassword() {
            const input = passwordInput.value.trim();
            if (input === 'üçÑ') {
                setTimeout(() => {
                    document.getElementById('view-1').style.display = 'none';
                    document.getElementById('view-2').style.display = 'block';
                    document.querySelector('.glass-card').style.height = 'auto'; 
                }, 300);
            } else {
                failedAttempts++;
                unlockBtn.classList.add('shake');
                setTimeout(() => unlockBtn.classList.remove('shake'), 400);
                hintBox.innerText = failedAttempts === 1 
                    ? "Try again, next time I will give you a hint :)" 
                    : "Hint: I have a thick hard stem and a red round cap, and sometimes I can get really excited üòâ";
            }
        }

        function checkAllViewed() {
            const viewed = document.querySelectorAll('.flip-card.viewed').length;
            const btn = document.getElementById('moreBtn');
            if (viewed === 8 && btn.style.display === 'none') {
                btn.style.display = 'flex';
            }
        }

        // --- VIEW TRANSITION TO GAME ---
        function showView3() {
            document.getElementById('view-2').style.display = 'none';
            document.getElementById('moreBtn').style.display = 'none';
            document.getElementById('view-3').style.display = 'flex';
            document.querySelector('.glass-card').style.height = 'auto';
        }

        // --- TIC TAC TOE LOGIC ---
        let board = ['', '', '', '', '', '', '', '', ''];
        let gameActive = false;
        let score = 0;
        const winningScore = 3;
        const playerIcon = 'üêÆ';
        const computerIcon = 'üçÑ';
        const winConditions = [
            [0,1,2], [3,4,5], [6,7,8], // Rows
            [0,3,6], [1,4,7], [2,5,8], // Cols
            [0,4,8], [2,4,6]           // Diags
        ];
        const popups = [
            "So proud of you <3",
            "I always believe in you",
            "Never give up sayang!"
        ];

        function startGame() {
            // Reset Board
            board = ['', '', '', '', '', '', '', '', ''];
            document.querySelectorAll('.cell').forEach(cell => {
                cell.innerText = '';
                cell.classList.remove('taken');
            });
            document.getElementById('gameCaption').innerText = "Win 3 times to proceed ü§≠";
            
            const btn = document.getElementById('gameStartBtn');
            btn.innerText = "YOU CAN DO IT!";
            btn.disabled = true;
            btn.classList.remove('shiny-btn');
            btn.style.background = '#ccc';

            gameActive = true;

            // Computer places first move immediately
            setTimeout(computerMove, 300);
        }

        function handleCellClick(index) {
            if (!gameActive || board[index] !== '') return;

            // Player Move
            placeMark(index, playerIcon);
            if (checkWin()) return;

            // Computer Move
            setTimeout(computerMove, 500);
        }

        function placeMark(index, mark) {
            board[index] = mark;
            const cell = document.getElementsByClassName('cell')[index];
            cell.innerText = mark;
            cell.classList.add('taken');
        }

        function computerMove() {
            if (!gameActive) return;

            // Find empty spots
            const emptyIndices = board.map((val, idx) => val === '' ? idx : null).filter(val => val !== null);
            
            if (emptyIndices.length > 0) {
                const randomIdx = emptyIndices[Math.floor(Math.random() * emptyIndices.length)];
                placeMark(randomIdx, computerIcon);
                checkWin();
            }
        }

        function checkWin() {
            let roundWon = false;
            let winner = null;

            for (let i = 0; i < winConditions.length; i++) {
                const [a, b, c] = winConditions[i];
                if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                    roundWon = true;
                    winner = board[a];
                    break;
                }
            }

            if (roundWon) {
                endGame(winner);
                return true;
            }

            if (!board.includes('')) {
                endGame('draw');
                return true;
            }
            return false;
        }

        function endGame(winner) {
            gameActive = false;
            const caption = document.getElementById('gameCaption');
            const btn = document.getElementById('gameStartBtn');

            if (winner === playerIcon) {
                score++;
                document.getElementById('scoreCounter').innerText = `üèÜ: ${score}/${winningScore}`;
                caption.innerText = "üêÆ won!";
                showPopup();
            } else if (winner === computerIcon) {
                caption.innerText = "üçÑ won!";
            } else {
                caption.innerText = "It's a draw!";
            }

            // Reset Button State
            if (score >= winningScore) {
                btn.innerText = "Ready for more?";
                btn.disabled = false;
                btn.style.background = ''; // reset to css
                btn.classList.add('shiny-btn');
                btn.onclick = () => alert("Proceeding to View 4... (coming soon!)"); 
            } else {
                btn.innerText = "START GAME";
                btn.disabled = false;
                btn.style.background = ''; // reset to css
                btn.classList.add('shiny-btn');
            }
        }

        function showPopup() {
            const msg = popups[Math.floor(Math.random() * popups.length)];
            const popupEl = document.createElement('div');
            popupEl.classList.add('popup-msg');
            popupEl.innerText = msg;
            
            document.querySelector('.glass-card').appendChild(popupEl);
            
            setTimeout(() => {
                popupEl.remove();
            }, 5000); // Popup lasts 5 seconds
        }
    </script>
</body>
</html>